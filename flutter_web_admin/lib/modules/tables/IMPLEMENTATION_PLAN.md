## 🎨 前端界面设计

### 1. 表格列表页面

**路由:** `/airtable/tables`

**功能:**
- 显示所有表格的卡片列表或表格列表
- 每个表格显示：名称、字段数量、行数、创建时间、更新时间
- 支持搜索表格
- 支持创建新表格
- 支持删除表格
- 点击表格进入表格详情页面

**界面元素:**
```
┌────────────────────────────────────────────────────────┐
│  🏠 Airtable 管理                      [🔍 搜索] [➕ 新建表格]  │
├────────────────────────────────────────────────────────┤
│                                                        │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐ │
│  │ 📊 客户管理   │  │ 📦 订单管理   │  │ 🏢 产品目录   │ │
│  │              │  │              │  │              │ │
│  │ 5 个字段     │  │ 8 个字段     │  │ 12 个字段    │ │
│  │ 120 行数据   │  │ 45 行数据    │  │ 200 行数据   │ │
│  │              │  │              │  │              │ │
│  │ 2025-01-01   │  │ 2025-01-05   │  │ 2025-01-10   │ │
│  │ [查看] [删除] │  │ [查看] [删除] │  │ [查看] [删除] │ │
│  └──────────────┘  └──────────────┘  └──────────────┘ │
│                                                        │
│  ┌──────────────┐  ┌──────────────┐                   │
│  │ 👥 团队成员   │  │ 📝 项目任务   │                   │
│  │              │  │              │                   │
│  │ 6 个字段     │  │ 10 个字段    │                   │
│  │ 25 行数据    │  │ 88 行数据    │                   │
│  │              │  │              │                   │
│  │ 2025-01-12   │  │ 2025-01-15   │                   │
│  │ [查看] [删除] │  │ [查看] [删除] │                   │
│  └──────────────┘  └──────────────┘                   │
│                                                        │
└────────────────────────────────────────────────────────┘
```

---

### 2. 表格详情页面（类似 Excel）

**路由:** `/airtable/tables/{id}`

**功能:**
- 显示完整的表格数据（类似 Excel 界面）
- 表头显示所有字段（列）
- 表体显示所有行数据
- 支持添加/删除字段
- 支持添加/删除行
- 支持编辑单元格数据
- 支持设置单元格关联
- 支持行拖拽排序
- 支持分页
- 支持搜索和筛选

**界面元素:**
```
┌────────────────────────────────────────────────────────────────────┐
│  ← 返回  📊 客户管理                    [🔍 搜索] [➕ 添加字段] [➕ 添加行]  │
├────────────────────────────────────────────────────────────────────┤
│                                                                    │
│  ┌──┬──────────┬──────────┬──────────────┬─────────┬─────────┐    │
│  │# │ 客户姓名 │ 联系电话 │ 邮箱地址      │ 公司    │ 操作    │    │
│  │  │ [✏️]     │ [✏️]     │ [✏️]         │ [✏️]    │         │    │
│  ├──┼──────────┼──────────┼──────────────┼─────────┼─────────┤    │
│  │1 │ 张三     │13800138..│zhangsan@...  │ ABC公司 │[✏️][🗑️]│    │
│  │2 │ 李四     │13900139..│lisi@...      │ XYZ公司 │[✏️][🗑️]│    │
│  │3 │ 王五     │13700137..│wangwu@...    │ DEF公司 │[✏️][🗑️]│    │
│  │4 │ 赵六     │13600136..│zhaoliu@...   │ GHI公司 │[✏️][🗑️]│    │
│  │5 │ 孙七     │13500135..│sunqi@...     │ JKL公司 │[✏️][🗑️]│    │
│  └──┴──────────┴──────────┴──────────────┴─────────┴─────────┘    │
│                                                                    │
│  [◀] 1 / 3 [▶]                                  共 120 行数据      │
│                                                                    │
└────────────────────────────────────────────────────────────────────┘
```

---

### 3. 字段管理对话框

**功能:**
- 添加新字段
- 编辑字段名称
- 删除字段
- 查看字段统计信息

**界面元素:**
```
┌────────────────────────────────────┐
│  ✨ 添加新字段              [✕]    │
├────────────────────────────────────┤
│                                    │
│  字段名称:                         │
│  ┌──────────────────────────────┐ │
│  │                              │ │
│  └──────────────────────────────┘ │
│                                    │
│                                    │
│         [取消]  [确定]             │
│                                    │
└────────────────────────────────────┘
```

---

### 4. 单元格编辑对话框

**功能:**
- 编辑单元格值
- 设置关联（关联到其他表格、字段、单元格）
- 查看和移除现有关联

**界面元素:**
```
┌──────────────────────────────────────────────┐
│  ✏️ 编辑单元格                      [✕]      │
├──────────────────────────────────────────────┤
│                                              │
│  字段: 客户姓名                              │
│  ┌────────────────────────────────────────┐ │
│  │ 张三                                   │ │
│  └────────────────────────────────────────┘ │
│                                              │
│  🔗 关联设置:                                │
│                                              │
│  关联到表格:                                 │
│  ┌────────────────────────────────────────┐ │
│  │ [选择表格 ▼]                           │ │
│  └────────────────────────────────────────┘ │
│                                              │
│  关联到字段:                                 │
│  ┌────────────────────────────────────────┐ │
│  │ [选择字段 ▼]                           │ │
│  └────────────────────────────────────────┘ │
│                                              │
│  关联到数据:                                 │
│  ┌────────────────────────────────────────┐ │
│  │ [搜索数据...]                          │ │
│  └────────────────────────────────────────┘ │
│                                              │
│  当前关联:                                   │
│  • 表格: 订单管理                            │
│  • 字段: 客户姓名                            │
│  • 数据: 张三                                │
│  [移除关联]                                  │
│                                              │
│              [取消]  [保存]                  │
│                                              │
└──────────────────────────────────────────────┘
```

---

### 5. 行操作功能

**功能:**
- 添加新行
- 删除单行
- 批量删除行
- 行拖拽排序
- 复制行

**界面交互:**
- 点击"添加行"按钮：在表格末尾添加新的空行
- 点击行的删除按钮：删除该行
- 选中多行后批量删除：显示批量删除按钮
- 拖拽行号：可以上下拖动行进行排序

---

### 6. 关联数据选择器

**功能:**
- 搜索可关联的数据
- 显示搜索结果列表
- 选择要关联的数据项

**界面元素:**
```
┌──────────────────────────────────────────────┐
│  🔗 选择关联数据                    [✕]      │
├──────────────────────────────────────────────┤
│                                              │
│  表格: 客户管理                              │
│  字段: 客户姓名                              │
│                                              │
│  ┌────────────────────────────────────────┐ │
│  │ 🔍 搜索...                             │ │
│  └────────────────────────────────────────┘ │
│                                              │
│  搜索结果:                                   │
│  ┌────────────────────────────────────────┐ │
│  │ ○ 张三 (第1行)                         │ │
│  │ ○ 张四 (第5行)                         │ │
│  │ ○ 张五 (第12行)                        │ │
│  │ ○ 小张 (第20行)                        │ │
│  └────────────────────────────────────────┘ │
│                                              │
│  [◀] 1 / 2 [▶]                              │
│                                              │
│              [取消]  [确定]                  │
│                                              │
└──────────────────────────────────────────────┘
```

---

## 📋 前端页面总结

### 需要创建的页面：

1. **表格列表页** (`/airtable/tables`)
   - 组件：`TableListPage`
   
2. **表格详情页** (`/airtable/tables/:id`)
   - 组件：`TableDetailPage`
   
3. **对话框组件:**
   - `CreateTableDialog` - 创建表格对话框
   - `EditTableDialog` - 编辑表格对话框
   - `CreateFieldDialog` - 创建字段对话框
   - `EditFieldDialog` - 编辑字段对话框
   - `EditCellDialog` - 编辑单元格对话框
   - `RelationSelectorDialog` - 关联数据选择器对话框
   - `DeleteConfirmDialog` - 删除确认对话框

4. **表格组件:**
   - `DataTable` - 主表格组件（类似 Excel）
   - `TableHeader` - 表头组件
   - `TableRow` - 表格行组件
   - `TableCell` - 表格单元格组件

---

### 前端实现（预计 5-7 天）

#### Step 1: 创建基础结构（Day 1）
- [ ] 创建路由配置
- [ ] 创建 API 服务类 (`AirtableService`)
- [ ] 创建数据模型类
- [ ] 创建状态管理（Provider/Riverpod）

#### Step 2: 实现表格列表页（Day 1-2）
- [ ] 创建 `TableListPage` 组件
- [ ] 实现表格卡片组件
- [ ] 实现搜索功能
- [ ] 实现创建表格对话框
- [ ] 实现删除表格功能
- [ ] 对接后端 API

#### Step 3: 实现表格详情页框架（Day 2-3）
- [ ] 创建 `TableDetailPage` 组件
- [ ] 创建 `DataTable` 组件（基础结构）
- [ ] 实现表头显示
- [ ] 实现数据行显示
- [ ] 实现分页功能
- [ ] 对接后端 API 获取数据

#### Step 4: 实现字段管理功能（Day 3-4）
- [ ] 创建 `CreateFieldDialog` 组件
- [ ] 创建 `EditFieldDialog` 组件
- [ ] 实现添加字段功能
- [ ] 实现编辑字段功能
- [ ] 实现删除字段功能
- [ ] 对接后端 API

#### Step 5: 实现行管理功能（Day 4）
- [ ] 实现添加行功能
- [ ] 实现删除行功能
- [ ] 实现批量删除功能
- [ ] 实现行拖拽排序
- [ ] 对接后端 API

#### Step 6: 实现单元格编辑功能（Day 5）
- [ ] 创建 `EditCellDialog` 组件
- [ ] 实现单元格双击编辑
- [ ] 实现单元格值保存
- [ ] 实现快捷键支持（Enter、Esc）
- [ ] 对接后端 API

#### Step 7: 实现关联功能（Day 6-7）
- [ ] 创建 `RelationSelectorDialog` 组件
- [ ] 实现关联数据搜索
- [ ] 实现关联数据选择
- [ ] 实现关联数据显示
- [ ] 实现移除关联功能
- [ ] 对接后端 API

#### Step 8: 优化和测试（Day 7）
- [ ] UI/UX 优化
- [ ] 响应式设计调整
- [ ] 错误处理和提示优化
- [ ] 性能优化（虚拟滚动等）
- [ ] 全面测试
- [ ] Bug 修复

---

## 📊 技术选型建议

### 后端
- **框架:** Serverpod（已有）
- **数据库:** PostgreSQL（已有）
- **ORM:** Serverpod Protocol（已生成）

### 前端
- **框架:** Flutter Web
- **状态管理:** Provider 或 Riverpod
- **HTTP 客户端:** serverpod_flutter（已有）
- **表格组件:** 自定义或使用 `data_table_2`
- **对话框:** 使用 Flutter 内置 Dialog
- **拖拽:** 使用 `reorderable_list` 或 `drag_and_drop_lists`

---

## 🎯 开发优先级

### P0 (必须实现)
1. Table CRUD
2. Field CRUD
3. Row CRUD
4. Item CRUD
5. 基础表格显示和编辑

### P1 (重要)
1. 关联数据功能
2. 搜索和筛选
3. 分页
4. 批量操作

### P2 (可选)
1. 行拖拽排序
2. 字段类型验证
3. 数据导入导出
4. 视图功能

---

## 📝 注意事项

1. **数据一致性:** 删除表格时要级联删除所有相关的 Field、Row、Item
2. **性能优化:** 大数据量时需要分页加载和虚拟滚动
3. **用户体验:** 所有操作都要有加载状态和错误提示
4. **权限控制:** 后续可能需要添加表格的权限管理
5. **数据验证:** 前后端都要做好参数验证
6. **事务处理:** 批量操作要使用数据库事务
7. **索引优化:** 为常用查询字段添加数据库索引

---

## 🚀 开始实施

现在我们可以开始实施了！建议按照以下顺序：

1. **先实现后端所有接口**（3-5天）
2. **再实现前端基础功能**（5-7天）
3. **最后优化和完善**（2-3天）

准备好了吗？我们从后端的 Table 管理接口开始实现！


